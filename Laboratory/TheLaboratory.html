<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>The Laboratory ‚Äî Archives</title>
  <meta name="description" content="The Laboratory Archives: anomaly index, founder logs, and test records." />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg: #0b0e12;
      --panel: #11161d;
      --panel-2:#0e1319;
      --text: #e6edf3;
      --muted:#93a2b3;
      --brand: #64b5ff;
      --brand-2:#3fd2c7;
      --accent: #9b8cff;
      --danger:#ff6370;
      --ok:#4cd195;
      --card:#121821;
      --card-border: rgba(255,255,255,0.06);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius-xl: 18px;
      --radius-lg: 14px;
      --radius-md: 10px;
      --radius-sm: 8px;
      --ring: 0 0 0 2px rgba(100,181,255,.25);
    }
    /* Light mode vars */
    [data-theme="light"]{
      --bg:#f6f8fb;
      --panel:#ffffff;
      --panel-2:#eef2f7;
      --text:#0f1720;
      --muted:#485567;
      --brand:#1565d8;
      --brand-2:#0aaea3;
      --accent:#6b5bff;
      --danger:#d62839;
      --ok:#119c6f;
      --card:#ffffff;
      --card-border: rgba(0,0,0,0.06);
      --shadow: 0 10px 30px rgba(0,0,0,.08);
      --ring: 0 0 0 2px rgba(21,101,216,.18);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji", "Segoe UI Symbol";
      background: radial-gradient(1200px 800px at 80% -10%, rgba(100,181,255,.08), transparent 60%),
                  radial-gradient(1400px 900px at -10% 90%, rgba(63,210,199,.06), transparent 60%), var(--bg);
      color:var(--text);
    }

    .layout{
      display:grid;
      grid-template-columns: 280px 1fr;
      grid-template-rows: 70px calc(100dvh - 70px);
      min-height:100dvh;
    }
    header{
      grid-column: 1/3;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:12px 18px;
      background:linear-gradient(180deg, rgba(255,255,255,.02), transparent), var(--panel-2);
      border-bottom:1px solid var(--card-border);
      box-shadow: var(--shadow);
      position:sticky; top:0; z-index:30;
    }
    .brand{
      display:flex; align-items:center; gap:12px;
    }
    .logo{
      width:40px; height:40px; border-radius:12px;
      background:
        conic-gradient(from 120deg, var(--brand), var(--accent), var(--brand-2), var(--brand));
      box-shadow:0 0 0 3px rgba(255,255,255,.04), 0 12px 30px rgba(79,209,197,.15);
    }
    .brand h1{
      font-size:18px; margin:0; letter-spacing:.3px; font-weight:800;
      background: linear-gradient(90deg, var(--text), var(--brand-2));
      -webkit-background-clip: text; background-clip:text; color:transparent;
    }
    .hdr-actions{display:flex; align-items:center; gap:10px;}
    .btn{
      appearance:none; border:1px solid var(--card-border); background:var(--panel);
      color:var(--text); border-radius:12px; padding:10px 14px; font-weight:600;
      transition:.2s ease; cursor:pointer; box-shadow: var(--shadow);
    }
    .btn:hover{ transform: translateY(-1px); }
    .btn:active{ transform: translateY(0); }
    .btn.primary{ background:linear-gradient(180deg, rgba(100,181,255,.18), rgba(100,181,255,.08)), var(--panel); border-color: rgba(100,181,255,.35);}
    .btn.ghost{ background:transparent; border-color:var(--card-border); }

    aside{
      border-right:1px solid var(--card-border);
      background: linear-gradient(180deg, rgba(255,255,255,.02), transparent), var(--panel);
      padding:16px;
      position:sticky; top:70px; height: calc(100dvh - 70px); overflow:auto;
    }
    nav .section-title{
      font-size:11px; letter-spacing:.18em; text-transform:uppercase; color:var(--muted);
      margin:16px 10px 8px;
    }
    .nav-list{display:flex; flex-direction:column; gap:6px; padding:0; margin:0; list-style:none;}
    .nav-link{
      display:flex; align-items:center; gap:10px; padding:10px 12px; border-radius:10px;
      color:var(--text); text-decoration:none; font-weight:600; border:1px solid transparent;
    }
    .nav-link:hover{ background: rgba(100,181,255,.08); border-color: rgba(100,181,255,.25); }
    .nav-link.active{ background: linear-gradient(180deg, rgba(100,181,255,.18), rgba(100,181,255,.08)); border-color: rgba(100,181,255,.4); }

    main{
      padding:24px; overflow:auto;
    }
    .hero{
      display:grid; grid-template-columns: 1.3fr 1fr; gap:18px; align-items:stretch; margin-bottom:18px;
    }
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.02), transparent), var(--card);
      border:1px solid var(--card-border);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow);
    }
    .hero .card{ padding:22px; }
    .hero h2{ margin:0 0 8px 0; font-size:28px; letter-spacing:.3px; }
    .muted{ color:var(--muted); }

    .kpis{ display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:12px; margin-top:14px; }
    .kpi{ padding:14px; border-radius:14px; border:1px solid var(--card-border); background:var(--panel); }
    .kpi strong{ font-size:22px; display:block; }
    .kpi span{ font-size:12px; color:var(--muted); }

    .pill{
      display:inline-flex; align-items:center; gap:8px; padding:8px 10px; border-radius:999px;
      background: rgba(63,210,199,.12); border:1px solid rgba(63,210,199,.35); color:var(--text); font-weight:700; font-size:12px;
    }
    .badge{ padding:4px 8px; border-radius:999px; font-weight:700; font-size:11px; border:1px solid var(--card-border); color:var(--muted); }
    .badge.red{ background: rgba(214,40,57,.1); border-color: rgba(214,40,57,.35); color:#ff9aa5; }
    .badge.yellow{ background: rgba(255,186,0,.08); border-color: rgba(255,186,0,.35); color:#ffd479; }
    .badge.black{ background: rgba(108,117,125,.12); border-color: rgba(108,117,125,.35); color:#c9ced6; }

    .grid{ display:grid; gap:14px; grid-template-columns: repeat(12, minmax(0,1fr)); }
    .col-12{ grid-column: span 12; }
    .col-6{ grid-column: span 6; }
    .col-4{ grid-column: span 4; }
    .col-8{ grid-column: span 8; }

    .searchbar{
      display:flex; align-items:center; gap:10px; padding:12px 14px; border-radius:14px;
      background:var(--panel); border:1px solid var(--card-border); box-shadow: var(--shadow);
    }
    .searchbar input{
      flex:1; background:transparent; border:none; outline:none; color:var(--text); font-size:14px;
    }

    .lr-list{ display:grid; grid-template-columns: repeat( auto-fill, minmax(260px,1fr) ); gap:14px; }
    .lr-card{
      padding:16px; border-radius:16px; border:1px solid var(--card-border);
      background: linear-gradient(180deg, rgba(255,255,255,.02), transparent), var(--panel);
      transition: .18s ease; position:relative; overflow:hidden; cursor:pointer;
    }
    .lr-card:hover{ transform: translateY(-3px); box-shadow: var(--shadow); }
    .lr-card h4{ margin:0 0 6px 0; }
    .lr-card .small{ font-size:12px; color:var(--muted); }
    .lr-card .chip{
      position:absolute; top:12px; right:12px; font-size:11px; padding:6px 8px; border-radius:999px;
      border:1px solid var(--card-border); background:rgba(255,255,255,.03); color:var(--muted); font-weight:700;
    }

    .doc{
      padding:22px; line-height:1.65;
    }
    .doc h2{ margin-top:0 }
    .doc pre{
      background: var(--panel);
      border:1px solid var(--card-border);
      padding:14px; border-radius:12px; overflow:auto;
    }
    code{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace }

    .footer{
      margin-top:18px; padding:14px; border-top:1px solid var(--card-border); color:var(--muted); font-size:13px;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }

    /* Modal */
    .modal{
      position:fixed; inset:0; display:none; align-items:center; justify-content:center; padding:24px; z-index:50;
      background: rgba(0,0,0,.45);
    }
    .modal.open{ display:flex; }
    .modal-panel{
      width:min(820px, 96vw); max-height:90dvh; overflow:auto; background:var(--panel); border:1px solid var(--card-border);
      border-radius:18px; box-shadow: var(--shadow); padding:18px 18px 8px;
    }
    .modal-head{ display:flex; align-items:center; justify-content:space-between; gap:10px; padding:6px 6px 10px 6px; position:sticky; top:0; background: var(--panel); }
    .close{ border:none; background:transparent; color:var(--muted); font-size:20px; cursor:pointer; padding:8px; border-radius:10px;}
    .close:hover{ background: rgba(255,255,255,.05); }

    /* Responsive */
    @media (max-width: 980px){
      .layout{ grid-template-columns: 1fr; grid-template-rows: auto auto 1fr; }
      aside{ position:static; height:auto; border-right:none; border-bottom:1px solid var(--card-border); }
      .hero{ grid-template-columns: 1fr; }
      .kpis{ grid-template-columns: repeat(2, minmax(0,1fr)); }
    }
    @media (max-width: 560px){
      header{ gap:8px; }
      .brand h1{ font-size:16px; }
    }
  </style>
</head>
<body data-theme="dark">
  <div class="layout">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <h1>The Laboratory ‚Äî Archives</h1>
      </div>
      <div class="hdr-actions">
        <button class="btn ghost" id="themeToggle" title="Toggle theme">üåó Theme</button>
        <a class="btn primary" href="https://github.com/" target="_blank" rel="noreferrer">View on GitHub</a>
      </div>
    </header>

    <aside>
      <nav>
        <div class="section-title">Navigation</div>
        <ul class="nav-list" id="nav">
          <li><a href="#/home" class="nav-link active">üè† Home</a></li>
          <li><a href="#/anomalies" class="nav-link">üß™ Anomalies</a></li>
          <li><a href="#/docs/lr-001" class="nav-link">üìÑ LR-001 Document</a></li>
          <li><a href="#/about" class="nav-link">‚ÑπÔ∏è About</a></li>
        </ul>

        <div class="section-title">Quick Stats</div>
        <div class="kpis">
          <div class="kpi"><strong id="kpiTotal">‚Äî</strong><span>Total LR Files</span></div>
          <div class="kpi"><strong id="kpiYellow">‚Äî</strong><span>Yellow</span></div>
          <div class="kpi"><strong id="kpiRed">‚Äî</strong><span>Red</span></div>
          <div class="kpi"><strong id="kpiBlack">‚Äî</strong><span>Black</span></div>
        </div>
      </nav>
    </aside>

    <main id="app">
      <!-- Content rendered by router -->
    </main>
  </div>

  <!-- Modal for LR detail -->
  <div class="modal" id="lrModal" aria-hidden="true" role="dialog" aria-label="LR details">
    <div class="modal-panel">
      <div class="modal-head">
        <h3 id="modalTitle" style="margin:0;"></h3>
        <button class="close" id="modalClose" aria-label="Close">‚úï</button>
      </div>
      <div id="modalBody" class="doc"></div>
    </div>
  </div>

  <script>
    // --- Data -----------------------------------------------------------------
    const LR_DATA = [
      {
        id:"lr-001",
        number:"LR-001",
        codename:"Serial Killer",
        zone:"Red",
        status:"Active",
        summary:"Immortal pursuit-class entity. Hunts one designated target at a time.",
        details: `
<h2>LR-001 ‚Äî ‚ÄúSerial Killer‚Äù</h2>
<p><strong>Classification:</strong> Red Zone<br>
<strong>Status:</strong> Active<br>
<strong>Threat Type:</strong> Pursuit-Class</p>
<p><strong>Overview:</strong> LR-001 relentlessly hunts a single target. It ignores all others until that target dies, then immediately re-targets the next subject in join order.</p>
<ul>
  <li><strong>Target Selection:</strong> First person to enter becomes first target; upon death, next joiner is targeted.</li>
  <li><strong>Immortality:</strong> No known termination method.</li>
  <li><strong>Collateral:</strong> Minimal unless obstructed.</li>
</ul>
<p><strong>Founder Notes</strong><br>
<i>Ton:</i> ‚ÄúHe only wants one person at a time. Polite.‚Äù<br>
<i>Light:</i> ‚ÄúStop running toward the crowd when he chases you.‚Äù</p>
        `
      },
      // Example placeholders you can fill as you publish more entries
      {
        id:"lr-002",
        number:"LR-002",
        codename:"Wau Tak Jadi",
        zone:"Yellow",
        status:"Active",
        summary:"Glitched wau-kite artifact with checkpoint-like teleport behavior.",
        details: `
<h2>LR-002 ‚Äî ‚ÄúWau Tak Jadi‚Äù</h2>
<p><strong>Classification:</strong> Yellow Zone<br>
<strong>Status:</strong> Active</p>
<p>Behaves as a positional checkpoint when grasped/ungasped; exhibits illusions to observers. Frequently used for mischief during tests.</p>
        `
      },
      {
        id:"lr-003",
        number:"LR-003",
        codename:"Orb Thingy",
        zone:"Yellow",
        status:"Active",
        summary:"Harmless-seeming orb that marks subjects. Ton reports sporadic damage; unverified.",
        details: `
<h2>LR-003 ‚Äî ‚ÄúOrb Thingy‚Äù</h2>
<p><strong>Classification:</strong> Yellow Zone<br>
<strong>Status:</strong> Active</p>
<p>Projects an orb marker above individuals. Founder dispute over hazard; incidents reported only when Ton tested it.</p>
        `
      },
      {
        id:"lr-004",
        number:"LR-004",
        codename:"Ghost Thingy",
        zone:"Yellow",
        status:"Active",
        summary:"Electronics flicker when approached; attacks if cornered.",
        details: `
<h2>LR-004 ‚Äî ‚ÄúGhost Thingy‚Äù</h2>
<p><strong>Classification:</strong> Yellow Zone<br>
<strong>Status:</strong> Active</p>
<p>Distorts lights and devices when a person nears; non-hostile until trapped. Founder Light scared; Ton called it 'building issue' at first.</p>
        `
      }
    ];

    // --- Utilities ------------------------------------------------------------
    const $ = sel => document.querySelector(sel);
    const $$ = sel => Array.from(document.querySelectorAll(sel));

    function setTheme(next){
      const root = document.body;
      const curr = root.getAttribute('data-theme') || 'dark';
      const final = next || (curr === 'dark' ? 'light' : 'dark');
      root.setAttribute('data-theme', final);
      localStorage.setItem('labTheme', final);
    }
    const savedTheme = localStorage.getItem('labTheme');
    if(savedTheme) document.body.setAttribute('data-theme', savedTheme);

    // KPIs
    function renderKpis(){
      $('#kpiTotal').textContent = LR_DATA.length;
      $('#kpiYellow').textContent = LR_DATA.filter(x=>x.zone==='Yellow').length;
      $('#kpiRed').textContent = LR_DATA.filter(x=>x.zone==='Red').length;
      $('#kpiBlack').textContent = LR_DATA.filter(x=>x.zone==='Black').length;
    }

    // Router
    function setActiveNav(hash){
      $$('#nav .nav-link').forEach(a=>{
        a.classList.toggle('active', a.getAttribute('href') === hash);
      });
    }

    function pageHome(){
      return `
        <section class="hero">
          <div class="card">
            <h2>Welcome, Scientist.</h2>
            <p class="muted">This is the public archive of <strong>The Laboratory</strong>. Browse LR files, read field notes, and pretend the Founders have a plan.</p>
            <div style="display:flex; gap:10px; margin:14px 0 6px;">
              <span class="pill">Experimental ‚Ä¢ Unethical ‚Ä¢ Fun</span>
            </div>
            <div style="margin-top:16px; display:flex; gap:10px; flex-wrap:wrap;">
              <a class="btn primary" href="#/anomalies">Browse Anomalies</a>
              <a class="btn" href="#/docs/lr-001">Read LR-001</a>
            </div>
          </div>
          <div class="card">
            <h2 style="margin-top:0;">Latest Notes</h2>
            <ul class="muted" style="margin:0 0 8px 18px;">
              <li>LR-001 remains immortal. Annoying.</li>
              <li>LR-002 teleport antics continue. Ton laughs, Light sighs.</li>
              <li>Min posted a bigger ‚ÄúDummy Here‚Äù sign. Still ignored.</li>
              <li>‚ÄúGreen Zone‚Äù removed from paperwork. Boring.</li>
            </ul>
            <div class="badge red">Warning: Mirrors deployed in east wing</div>
          </div>
        </section>

        <section class="grid">
          <div class="col-12">
            <div class="card" style="padding:16px;">
              <div class="searchbar">
                <span>üîé</span>
                <input id="search" placeholder="Search LR number, codename, or zone‚Ä¶" />
              </div>
              <div id="lrList" class="lr-list" style="margin-top:12px;"></div>
            </div>
          </div>
        </section>

        <div class="footer">
          <span>¬© The Laboratory ‚Ä¢ Founders: Light & Ton_Cheese</span>
          <span>Built for GitHub Pages</span>
        </div>
      `;
    }

    function pageAnomalies(){
      return `
        <section class="card" style="padding:18px;">
          <h2 style="margin-top:0;">Anomalies</h2>
          <p class="muted">A selection of LR files. Order reflects discovery, not power.</p>
          <div class="searchbar" style="margin-top:12px;">
            <span>üîé</span>
            <input id="search" placeholder="Filter anomalies‚Ä¶" />
          </div>
          <div id="lrList" class="lr-list" style="margin-top:12px;"></div>
        </section>
        <div class="footer">
          <span>Yellow = won‚Äôt kill you (until you do something). Red = will kill you. Black = kills the world.</span>
        </div>
      `;
    }

    function pageDoc(id){
      const entry = LR_DATA.find(x => x.id === id);
      const title = entry ? `${entry.number} ‚Äî ${entry.codename}` : 'Document';
      const body = entry ? entry.details : `<p>Document not found.</p>`;
      return `
        <section class="card doc">
          <h2 style="margin:0 0 6px 0;">${title}</h2>
          <div class="badge ${entry?.zone?.toLowerCase() || ''}">${entry?.zone || '‚Äî'} Zone</div>
          <div style="height:10px"></div>
          ${body}
          <pre><code>Filed by: Min Kuznetzov (intern). Reviewed by Founders.</code></pre>
        </section>
        <div class="footer">
          <span>Status: Open for cross-tests ‚Ä¢ Do not sell anomalies</span>
          <span>Document ID: ${entry?.number || '‚Äî'}</span>
        </div>
      `;
    }

    function pageAbout(){
      return `
        <section class="card doc">
          <h2>About The Laboratory</h2>
          <p>No ethics board. No security department. Just testing. If it doesn‚Äôt belong, it‚Äôs neutralized.</p>
          <ul>
            <li><strong>Yellow:</strong> Won‚Äôt kill you‚Ä¶ unless you do something stupid.</li>
            <li><strong>Red:</strong> Will kill you.</li>
            <li><strong>Black:</strong> Might kill the planet.</li>
          </ul>
          <p><strong>Ownership:</strong> All anomalies are property of Founders Light & Ton. You may test, cross-test, and observe. You may not sell or release.</p>
          <p><strong>Key NPCs:</strong> Min (intern, polite), Mia (mercenary, unpredictable).</p>
        </section>
      `;
    }

    function renderLRList(rootId, filter=""){
      const root = document.getElementById(rootId);
      const q = filter.trim().toLowerCase();
      const items = LR_DATA.filter(x=>{
        if(!q) return true;
        return (x.number + " " + x.codename + " " + x.zone).toLowerCase().includes(q);
      });
      if(items.length===0){
        root.innerHTML = `<div class="muted" style="padding:10px;">No matches.</div>`;
        return;
      }
      root.innerHTML = items.map(x=>`
        <article class="lr-card" data-id="${x.id}" tabindex="0" role="button" aria-label="${x.number}: ${x.codename}">
          <span class="chip">${x.number}</span>
          <h4>${x.codename}</h4>
          <div class="small" style="margin:6px 0 10px">${x.summary}</div>
          <div class="badge ${x.zone.toLowerCase()}">${x.zone}</div>
          <span class="badge" style="margin-left:6px;">${x.status}</span>
        </article>
      `).join('');
      // Bind open modal
      root.querySelectorAll('.lr-card').forEach(card=>{
        card.addEventListener('click', ()=>{
          const id = card.getAttribute('data-id');
          openModalFor(id);
        });
        card.addEventListener('keypress', (e)=>{
          if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); card.click(); }
        });
      });
    }

    function openModalFor(id){
      const entry = LR_DATA.find(x=>x.id===id);
      if(!entry) return;
      $('#modalTitle').textContent = `${entry.number} ‚Äî ${entry.codename}`;
      $('#modalBody').innerHTML = entry.details;
      $('#lrModal').classList.add('open');
      $('#lrModal').setAttribute('aria-hidden','false');
    }
    function closeModal(){
      $('#lrModal').classList.remove('open');
      $('#lrModal').setAttribute('aria-hidden','true');
    }

    // Initial render
    function render(){
      renderKpis();
      const hash = location.hash || '#/home';
      setActiveNav(hash);
      const main = $('#app');

      // Routes
      if(hash.startsWith('#/home')){
        main.innerHTML = pageHome();
        renderLRList('lrList', '');
        bindSearch();
      } else if(hash.startsWith('#/anomalies')){
        main.innerHTML = pageAnomalies();
        renderLRList('lrList', '');
        bindSearch();
      } else if(hash.startsWith('#/docs/')){
        const id = hash.split('/')[2];
        main.innerHTML = pageDoc(id);
      } else if(hash.startsWith('#/about')){
        main.innerHTML = pageAbout();
      } else {
        location.hash = '#/home';
      }
    }

    function bindSearch(){
      const input = $('#search');
      if(!input) return;
      input.addEventListener('input', (e)=>{
        renderLRList('lrList', e.target.value);
      });
    }

    // Events
    window.addEventListener('hashchange', render);
    document.getElementById('themeToggle').addEventListener('click', ()=>setTheme());
    document.getElementById('modalClose').addEventListener('click', closeModal);
    document.getElementById('lrModal').addEventListener('click', (e)=>{ if(e.target.id==='lrModal') closeModal(); });

    // Keyboard: Escape closes modal
    window.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeModal(); });

    // Kick off
    render();
  </script>
</body>
</html>
